import{k as $,r as d,l as q,o as H,a as p,s as z,w as F,h as o,b as e,c as r,j as c,F as k,g as w,t as n,q as R,p as T,v as I,x as m,y as h,i as G,U as N}from"./index-L-wCIgqC.js";import{_ as O}from"./AdminLayout-C2pOfWaN.js";const Y={class:"p-6"},J={key:0,class:"text-center py-12"},Q={key:1,class:"bg-white rounded-2xl shadow-sm border border-gray-100 overflow-hidden"},X={class:"min-w-full divide-y divide-gray-200"},Z={class:"divide-y divide-gray-100"},ee={class:"px-6 py-4"},te={class:"flex items-center space-x-3"},se={class:"w-10 h-10 bg-gradient-to-br from-bpjs-400 to-bpjs-600 rounded-full flex items-center justify-center"},ae={class:"text-white font-bold"},le={class:"font-medium text-gray-900"},oe={class:"text-xs text-gray-500"},re={class:"px-6 py-4"},ne={class:"text-gray-700"},ie={class:"px-6 py-4"},de={class:"px-6 py-4"},ue={key:0,class:"text-gray-700"},pe={key:1,class:"text-gray-400"},ce={class:"px-6 py-4"},me={key:0,class:"flex items-center space-x-2"},ve=["onClick"],xe=["onClick"],be={key:1,class:"text-gray-400 text-sm"},ye={key:0,class:"text-center py-12"},fe={class:"bg-white rounded-2xl shadow-xl w-full max-w-md"},ge={class:"p-6 border-b border-gray-100"},ke={class:"text-xl font-bold text-gray-900"},we=["disabled"],he={class:"block text-sm font-medium text-gray-700 mb-1"},_e={key:0,class:"text-gray-400 font-normal"},Ae=["required"],Me=["value"],Pe={key:0},Ke=["value"],je={class:"flex justify-end space-x-3 pt-4"},Ie=["disabled"],Ne={key:0},De={key:1},Be={__name:"AdminManagePage",setup(Ce){const v=$(),y=d([]),f=d(!0),u=d(!1),i=d(!1),x=d(!1),a=d({id:null,username:"",password:"",nama:"",role:"ADMIN_KP",kepwil:""}),_=d([]),A=d(!1),D=q(()=>v.isSuperAdmin?[{value:"SUPER_ADMIN",label:"Super Admin"},{value:"ADMIN_KP",label:"Admin KP (Kantor Pusat)"},{value:"ADMIN_KEPWIL",label:"Admin Kepwil (Kantor Wilayah)"}]:[{value:"ADMIN_KP",label:"Admin KP (Kantor Pusat)"},{value:"ADMIN_KEPWIL",label:"Admin Kepwil (Kantor Wilayah)"}]),M={SUPER_ADMIN:{label:"Super Admin",color:"bg-purple-100 text-purple-800"},ADMIN_KP:{label:"Admin KP",color:"bg-blue-100 text-blue-800"},ADMIN_KEPWIL:{label:"Admin Kepwil",color:"bg-emerald-100 text-emerald-800"}};H(async()=>{await Promise.all([g(),C()])});async function g(){f.value=!0;try{const l=await p.get("/admin/list");y.value=l.data}catch(l){console.error("Failed to fetch admins:",l)}finally{f.value=!1}}async function C(){A.value=!0;try{const l=await p.get("/lokasi/provinsi");_.value=l.data.data}catch(l){console.error("Failed to fetch provinsi:",l)}finally{A.value=!1}}function E(){a.value={id:null,username:"",password:"",nama:"",role:"ADMIN_KP",kepwil:""}}function S(){E(),i.value=!1,u.value=!0}function B(l){a.value={id:l.id,username:l.username,password:"",nama:l.nama,role:l.role,kepwil:l.kepwil||""},i.value=!0,u.value=!0}async function L(){var l,t;x.value=!0;try{i.value?await p.put(`/admin/${a.value.id}`,{nama:a.value.nama,password:a.value.password||void 0,role:a.value.role,kepwil:a.value.role==="ADMIN_KEPWIL"?a.value.kepwil:null}):await p.post("/admin/create",{username:a.value.username,password:a.value.password,nama:a.value.nama,role:a.value.role,kepwil:a.value.role==="ADMIN_KEPWIL"?a.value.kepwil:null}),u.value=!1,await g()}catch(s){alert(((t=(l=s.response)==null?void 0:l.data)==null?void 0:t.error)||"Gagal menyimpan admin")}finally{x.value=!1}}async function U(l){var t,s;if(confirm(`Yakin ingin menghapus admin "${l.nama}"?`))try{await p.delete(`/admin/${l.id}`),await g()}catch(b){alert(((s=(t=b.response)==null?void 0:t.data)==null?void 0:s.error)||"Gagal menghapus admin")}}function W(l){return!!(v.isSuperAdmin||v.isAdminKP&&l.role!=="SUPER_ADMIN")}return(l,t)=>(o(),z(O,null,{default:F(()=>[e("div",Y,[e("div",{class:"flex items-center justify-between mb-6"},[t[8]||(t[8]=e("div",null,[e("h1",{class:"text-2xl font-bold text-gray-900"},"Kelola Admin"),e("p",{class:"text-gray-500 mt-1"},"Manajemen akun administrator sistem")],-1)),e("button",{onClick:S,class:"px-4 py-2 bg-bpjs-600 text-white rounded-xl hover:bg-bpjs-700 transition-colors flex items-center space-x-2"},[...t[7]||(t[7]=[e("svg",{class:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 6v6m0 0v6m0-6h6m-6 0H6"})],-1),e("span",null,"Tambah Admin",-1)])])]),f.value?(o(),r("div",J,[...t[9]||(t[9]=[e("div",{class:"inline-block animate-spin rounded-full h-8 w-8 border-4 border-bpjs-500 border-t-transparent"},null,-1),e("p",{class:"mt-2 text-gray-500"},"Memuat data admin...",-1)])])):(o(),r("div",Q,[e("table",X,[t[12]||(t[12]=e("thead",{class:"bg-gray-50"},[e("tr",null,[e("th",{class:"px-6 py-4 text-left text-xs font-semibold text-gray-600 uppercase tracking-wider"},"Admin"),e("th",{class:"px-6 py-4 text-left text-xs font-semibold text-gray-600 uppercase tracking-wider"},"Username"),e("th",{class:"px-6 py-4 text-left text-xs font-semibold text-gray-600 uppercase tracking-wider"},"Role"),e("th",{class:"px-6 py-4 text-left text-xs font-semibold text-gray-600 uppercase tracking-wider"},"Wilayah"),e("th",{class:"px-6 py-4 text-left text-xs font-semibold text-gray-600 uppercase tracking-wider"},"Aksi")])],-1)),e("tbody",Z,[(o(!0),r(k,null,w(y.value,s=>{var b,P,K,j;return o(),r("tr",{key:s.id,class:"hover:bg-gray-50 transition-colors"},[e("td",ee,[e("div",te,[e("div",se,[e("span",ae,n(((b=s.nama)==null?void 0:b.charAt(0))||"A"),1)]),e("div",null,[e("p",le,n(s.nama),1),e("p",oe,"ID: "+n(s.id),1)])])]),e("td",re,[e("span",ne,n(s.username),1)]),e("td",ie,[e("span",{class:R(["inline-flex px-3 py-1 rounded-full text-xs font-medium",((P=M[s.role])==null?void 0:P.color)||"bg-gray-100 text-gray-800"])},n(((K=M[s.role])==null?void 0:K.label)||s.role),3)]),e("td",de,[s.kepwil?(o(),r("span",ue,n(s.kepwil),1)):(o(),r("span",pe,"-"))]),e("td",ce,[W(s)?(o(),r("div",me,[e("button",{onClick:V=>B(s),class:"p-2 text-blue-600 hover:bg-blue-50 rounded-lg transition-colors",title:"Edit"},[...t[10]||(t[10]=[e("svg",{class:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-1.414-9.414a2 2 0 112.828 2.828L11.828 15H9v-2.828l8.586-8.586z"})],-1)])],8,ve),s.id!==((j=T(v).user)==null?void 0:j.id)?(o(),r("button",{key:0,onClick:V=>U(s),class:"p-2 text-red-600 hover:bg-red-50 rounded-lg transition-colors",title:"Hapus"},[...t[11]||(t[11]=[e("svg",{class:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"})],-1)])],8,xe)):c("",!0)])):(o(),r("span",be,"-"))])])}),128))])]),y.value.length===0?(o(),r("div",ye,[...t[13]||(t[13]=[e("svg",{class:"mx-auto h-12 w-12 text-gray-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 4.354a4 4 0 110 5.292M15 21H3v-1a6 6 0 0112 0v1zm0 0h6v-1a6 6 0 00-9-5.197M13 7a4 4 0 11-8 0 4 4 0 018 0z"})],-1),e("p",{class:"mt-2 text-gray-500"},"Belum ada admin",-1)])])):c("",!0)])),u.value?(o(),r("div",{key:2,class:"fixed inset-0 bg-black/50 flex items-center justify-center z-50 p-4",onClick:t[6]||(t[6]=I(s=>u.value=!1,["self"]))},[e("div",fe,[e("div",ge,[e("h2",ke,n(i.value?"Edit Admin":"Tambah Admin Baru"),1)]),e("form",{onSubmit:I(L,["prevent"]),class:"p-6 space-y-4"},[e("div",null,[t[14]||(t[14]=e("label",{class:"block text-sm font-medium text-gray-700 mb-1"},"Username",-1)),m(e("input",{"onUpdate:modelValue":t[0]||(t[0]=s=>a.value.username=s),type:"text",disabled:i.value,required:"",class:"w-full px-4 py-2 border border-gray-300 rounded-xl focus:ring-2 focus:ring-bpjs-500 focus:border-transparent disabled:bg-gray-100",placeholder:"username"},null,8,we),[[h,a.value.username]])]),e("div",null,[e("label",he,[t[15]||(t[15]=G(" Password ",-1)),i.value?(o(),r("span",_e,"(kosongkan jika tidak ingin mengubah)")):c("",!0)]),m(e("input",{"onUpdate:modelValue":t[1]||(t[1]=s=>a.value.password=s),type:"password",required:!i.value,class:"w-full px-4 py-2 border border-gray-300 rounded-xl focus:ring-2 focus:ring-bpjs-500 focus:border-transparent",placeholder:"********"},null,8,Ae),[[h,a.value.password]])]),e("div",null,[t[16]||(t[16]=e("label",{class:"block text-sm font-medium text-gray-700 mb-1"},"Nama Lengkap",-1)),m(e("input",{"onUpdate:modelValue":t[2]||(t[2]=s=>a.value.nama=s),type:"text",required:"",class:"w-full px-4 py-2 border border-gray-300 rounded-xl focus:ring-2 focus:ring-bpjs-500 focus:border-transparent",placeholder:"Nama lengkap admin"},null,512),[[h,a.value.nama]])]),e("div",null,[t[17]||(t[17]=e("label",{class:"block text-sm font-medium text-gray-700 mb-1"},"Role",-1)),m(e("select",{"onUpdate:modelValue":t[3]||(t[3]=s=>a.value.role=s),required:"",class:"w-full px-4 py-2 border border-gray-300 rounded-xl focus:ring-2 focus:ring-bpjs-500 focus:border-transparent"},[(o(!0),r(k,null,w(D.value,s=>(o(),r("option",{key:s.value,value:s.value},n(s.label),9,Me))),128))],512),[[N,a.value.role]])]),a.value.role==="ADMIN_KEPWIL"?(o(),r("div",Pe,[t[19]||(t[19]=e("label",{class:"block text-sm font-medium text-gray-700 mb-1"},"Kantor Wilayah",-1)),m(e("select",{"onUpdate:modelValue":t[4]||(t[4]=s=>a.value.kepwil=s),required:"",class:"w-full px-4 py-2 border border-gray-300 rounded-xl focus:ring-2 focus:ring-bpjs-500 focus:border-transparent"},[t[18]||(t[18]=e("option",{value:""},"Pilih Wilayah...",-1)),(o(!0),r(k,null,w(_.value,s=>(o(),r("option",{key:s.id,value:s.nama},n(s.nama),9,Ke))),128))],512),[[N,a.value.kepwil]]),t[20]||(t[20]=e("p",{class:"text-xs text-gray-500 mt-1"},"Admin hanya dapat mengakses data di wilayah ini",-1))])):c("",!0),e("div",je,[e("button",{type:"button",onClick:t[5]||(t[5]=s=>u.value=!1),class:"px-4 py-2 text-gray-700 hover:bg-gray-100 rounded-xl transition-colors"}," Batal "),e("button",{type:"submit",disabled:x.value,class:"px-4 py-2 bg-bpjs-600 text-white rounded-xl hover:bg-bpjs-700 transition-colors disabled:opacity-50 flex items-center space-x-2"},[x.value?(o(),r("span",Ne,"Menyimpan...")):(o(),r("span",De,n(i.value?"Simpan Perubahan":"Tambah Admin"),1))],8,Ie)])],32)])])):c("",!0)])]),_:1}))}};export{Be as default};
