import{r,o as I,a as m,z as N,w as U,h as n,b as t,c as i,j as q,F as p,g as y,y as C,t as o,q as D,s as v,v as x,U as E}from"./index-Cv3Gfbck.js";import{_ as G}from"./AdminLayout-DzmIWmFz.js";const P={class:"p-6"},z={key:0,class:"flex justify-center py-20"},O={key:1,class:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4"},A={class:"font-bold text-gray-800"},H={class:"text-sm text-gray-500 mb-2"},L={class:"text-xs text-gray-400 mb-4"},W={class:"flex items-center justify-between text-sm"},Y={class:"text-gray-500"},J={class:"flex space-x-2"},Q=["onClick"],R=["onClick"],X={key:2,class:"fixed inset-0 bg-black/50 flex items-center justify-center z-50 p-4"},Z={class:"bg-white rounded-2xl p-6 max-w-lg w-full max-h-[90vh] overflow-y-auto"},ee={class:"text-xl font-bold mb-4"},te={class:"mb-4"},ae={class:"mb-4"},se={class:"mb-4"},le={class:"mb-4"},oe=["value"],ne={class:"mb-6"},ie={class:"grid grid-cols-2 gap-2"},re=["onClick"],de={class:"flex space-x-3"},ue=["disabled"],ve={__name:"ModulManagePage",setup(me){const _=r([]),k=r([]),g=r(!0),d=r(!1),c=r(!1),s=r({id:null,nama:"",deskripsi:"",durasi:30,subKategoriId:"",gradientFrom:"blue-500",gradientTo:"indigo-600"}),b=r(!1),K=[{from:"violet-500",to:"purple-600",name:"Violet-Purple"},{from:"blue-500",to:"indigo-600",name:"Blue-Indigo"},{from:"teal-500",to:"cyan-600",name:"Teal-Cyan"},{from:"amber-500",to:"orange-600",name:"Amber-Orange"}];I(async()=>{await Promise.all([f(),$()])});async function $(){const l=await m.get("/kategori");k.value=l.data.flatMap(a=>a.subKategoris.map(e=>({...e,kategoriNama:a.nama})))}async function f(){g.value=!0;try{const l=await m.get("/modul");_.value=l.data}catch(l){console.error(l)}finally{g.value=!1}}function j(){c.value=!1,s.value={id:null,nama:"",deskripsi:"",durasi:30,subKategoriId:"",gradientFrom:"blue-500",gradientTo:"indigo-600"},d.value=!0}function T(l){c.value=!0,s.value={...l},d.value=!0}async function F(){var l,a;b.value=!0;try{c.value?await m.put(`/modul/${s.value.id}`,s.value):await m.post("/modul",s.value),d.value=!1,f()}catch(e){alert(((a=(l=e.response)==null?void 0:l.data)==null?void 0:a.error)||"Gagal menyimpan")}finally{b.value=!1}}async function S(l){var a,e;if(confirm("Yakin hapus modul ini?"))try{await m.delete(`/modul/${l}`),f()}catch(u){alert(((e=(a=u.response)==null?void 0:a.data)==null?void 0:e.error)||"Gagal menghapus")}}function V(l){s.value.gradientFrom=l.from,s.value.gradientTo=l.to}return(l,a)=>(n(),N(G,null,{default:U(()=>[t("div",P,[t("div",{class:"flex items-center justify-between mb-6"},[a[5]||(a[5]=t("h1",{class:"text-2xl font-bold text-gray-800"},"Manajemen Modul",-1)),t("button",{onClick:j,class:"btn-primary"}," + Tambah Modul ")]),g.value?(n(),i("div",z,[...a[6]||(a[6]=[t("div",{class:"animate-spin rounded-full h-12 w-12 border-b-2 border-bpjs-500"},null,-1)])])):(n(),i("div",O,[(n(!0),i(p,null,y(_.value,e=>{var u,h,w,M;return n(),i("div",{key:e.id,class:"card"},[t("div",{class:C(["w-full h-24 rounded-xl mb-4",`bg-gradient-to-br from-${e.gradientFrom} to-${e.gradientTo}`])},null,2),t("h3",A,o(e.nama),1),t("p",H,o(e.deskripsi),1),t("p",L,o((h=(u=e.subKategori)==null?void 0:u.kategori)==null?void 0:h.nama)+" - "+o((w=e.subKategori)==null?void 0:w.nama),1),t("div",W,[t("span",Y,o(e.durasi)+" menit | "+o(((M=e._count)==null?void 0:M.soals)||0)+" soal",1),t("div",J,[t("button",{onClick:B=>T(e),class:"text-bpjs-600 hover:text-bpjs-800"},"Edit",8,Q),t("button",{onClick:B=>S(e.id),class:"text-red-600 hover:text-red-800"},"Hapus",8,R)])])])}),128))])),d.value?(n(),i("div",X,[t("div",Z,[t("h2",ee,o(c.value?"Edit Modul":"Tambah Modul"),1),t("form",{onSubmit:D(F,["prevent"])},[t("div",te,[a[7]||(a[7]=t("label",{class:"block text-gray-700 mb-2"},"Nama Modul",-1)),v(t("input",{"onUpdate:modelValue":a[0]||(a[0]=e=>s.value.nama=e),type:"text",class:"input-field",required:""},null,512),[[x,s.value.nama]])]),t("div",ae,[a[8]||(a[8]=t("label",{class:"block text-gray-700 mb-2"},"Deskripsi",-1)),v(t("textarea",{"onUpdate:modelValue":a[1]||(a[1]=e=>s.value.deskripsi=e),class:"input-field",rows:"2"},null,512),[[x,s.value.deskripsi]])]),t("div",se,[a[9]||(a[9]=t("label",{class:"block text-gray-700 mb-2"},"Durasi (menit)",-1)),v(t("input",{"onUpdate:modelValue":a[2]||(a[2]=e=>s.value.durasi=e),type:"number",class:"input-field",min:"1",required:""},null,512),[[x,s.value.durasi,void 0,{number:!0}]])]),t("div",le,[a[11]||(a[11]=t("label",{class:"block text-gray-700 mb-2"},"Sub Kategori",-1)),v(t("select",{"onUpdate:modelValue":a[3]||(a[3]=e=>s.value.subKategoriId=e),class:"input-field",required:""},[a[10]||(a[10]=t("option",{value:""},"Pilih Sub Kategori",-1)),(n(!0),i(p,null,y(k.value,e=>(n(),i("option",{key:e.id,value:e.id},o(e.kategoriNama)+" - "+o(e.nama),9,oe))),128))],512),[[E,s.value.subKategoriId]])]),t("div",ne,[a[12]||(a[12]=t("label",{class:"block text-gray-700 mb-2"},"Warna Gradient",-1)),t("div",ie,[(n(),i(p,null,y(K,e=>t("button",{key:e.name,type:"button",onClick:u=>V(e),class:C(["h-12 rounded-xl border-2 transition-all",[`bg-gradient-to-br from-${e.from} to-${e.to}`,s.value.gradientFrom===e.from?"border-gray-800 ring-2 ring-offset-2":"border-transparent"]])},null,10,re)),64))])]),t("div",de,[t("button",{type:"button",onClick:a[4]||(a[4]=e=>d.value=!1),class:"flex-1 btn-secondary"},"Batal"),t("button",{type:"submit",class:"flex-1 btn-primary",disabled:b.value},o(b.value?"Menyimpan...":"Simpan"),9,ue)])],32)])])):q("",!0)])]),_:1}))}};export{ve as default};
